<p align="center">
  <a href="https://mvs.org/">
    <img src="https://mvs.org/images/metaverselogo.png" alt="">
  </a>
</p>

# MetaverseJS
[![Build Status](https://travis-ci.org/canguruhh/metaversejs.png?branch=master)](https://travis-ci.org/canguruhh/metaversejs)
A javascript library for the Metaverse blockchain.

## Installation
Install using npm:
``` bash
npm install metaversejs
```

## Setup
### NodeJS
``` javascript
let Metaverse = require('metaversejs');
```
<a href="https://nodei.co/npm/metaversejs/"><img src="https://nodei.co/npm/metaversejs.png?downloads=true&downloadRank=true&stars=true"></a>
### Browser
For use in webapps the npm package contains a dist/metaverse.min.js. You can generate this file from source using grunt.

## Usage

Please also check the examples folder.

### Wallet generation
``` javascript
let Metaverse = require('metaversejs')

let number_of_addresses = 10

Metaverse.wallet.generateMnemonic()
  .then( (mnemonic) => Metaverse.wallet.fromMnemonic(mnemonic) )
  .then( (wallet)   => {
      let addresses=[]
      for (let i=0; i<number_of_addresses; i++) {
          addresses.push(wallet.getAddress(i))
      } 
      return { "mnemonic": mnemonic, "addresses": addresses, "wallet": wallet }
  })
  .then(console.log)
```
This will generate a new random wallet and return the mnemonic words as well as the first 10 addresses of the wallet.

### Transaction creation
As Metaverse is UTXO based you need to specify the inputs and outputs of the transaction. The following example creates a basic P2PKH (pay to public key hash) transaction.
``` javascript
//Transaction object
var tx = new Metaverse.transaction()
//Add inputs
tx.addInput("MKXYH2MhpvA3GU7kMk8y3SoywGnyHEj5SB","5554b27dbf657d008511df56e747ffb2173749fd933b03317cee3c1fde271aea",1)
//Add outputs
tx.addOutput("MVpxH8aAa3BAXvbdqUUJwEP6s2ajGKKtyd","ETP",1)
tx.addOutput("MKXYH2MhpvA3GU7kMk8y3SoywGnyHEj5SB","ETP",4939995)
console.log('transaction details: ' + tx)
//Sign the inputs
wallet.sign(tx)
    .then( (stx) => {
        console.log('signed transaction: ' + stx)
        //Encode (serialize) the transaction
        return stx.encode()
    })
    .then( (raw_tx) => {
        console.log('Encoded transaction: ' + raw_tx)
    })
```
You can also add other assets to the transaction. The resulting raw transaction can be broadcasted to any blockchain nodes. It is not possible to change the transaction without invalidating the signatures.

### Deposit
In order to create a deposit and get interest you just have to add a lock output to a transaction. Possible values for the locktime are: 25200, 108000, 331200, 655200 and 1314000 blocks.
``` javascript
//Transaction object
var tx = new Metaverse.transaction()
//Add inputs
tx.addInput("MKXYH2MhpvA3GU7kMk8y3SoywGnyHEj5SB","5554b27dbf657d008511df56e747ffb2173749fd933b03317cee3c1fde271aea",1)
//Add outputs
tx.addLockOutput("MVpxH8aAa3BAXvbdqUUJwEP6s2ajGKKtyd",1, 25200) //Lock for 25200 blocks
tx.addOutput("MKXYH2MhpvA3GU7kMk8y3SoywGnyHEj5SB","ETP",4939995)
console.log('transaction details: ' + tx)
//Sign the inputs
wallet.sign(tx)
    .then( (stx) => {
        console.log('signed transaction: ' + stx)
        //Encode (serialize) the transaction
        return stx.encode()
    })
    .then( (raw_tx) => {
        console.log('Encoded transaction: ' + raw_tx)
    })
```
The reward transaction will be generated by the miner of the block that will contain the transaction.


## Testing
To run the unit tests just execute:
``` bash
npm test
```



